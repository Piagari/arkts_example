/**
 * ä¸»é¡µé¢ - åŒ…å«åº•éƒ¨å¯¼èˆªæ å’Œå››ä¸ªä¸»è¦Tabé¡µé¢
 */
import { HomePage } from './HomePage';
import { CategoryPage } from './CategoryPage';
import { CartPage } from './CartPage';
import { MePage } from './MePage';
import { AppColors } from '../theme/AppColors';
import { AppDimensions } from '../theme/AppDimensions';
import { AppTypography } from '../theme/AppTypography';

@Entry
@Component
struct MainPage {
  @State currentTabIndex: number = 0;

  // Tab é…ç½®
  private tabItems: TabItem[] = [
    { name: 'é¦–é¡µ', icon: $r('app.media.ic_home'), selectedIcon: $r('app.media.ic_home') },
    { name: 'åˆ†ç±»', icon: $r('app.media.ic_category'), selectedIcon: $r('app.media.ic_category') },
    { name: 'è´­ç‰©è½¦', icon: $r('app.media.ic_cart'), selectedIcon: $r('app.media.ic_cart') },
    { name: 'æˆ‘çš„', icon: $r('app.media.ic_person'), selectedIcon: $r('app.media.ic_person') }
  ];

  @Builder
  TabItemBuilder(item: TabItem, index: number) {
    Column({ space: AppDimensions.spaceXSmall }) {
      // ä½¿ç”¨æ–‡å­—å›¾æ ‡ä»£æ›¿SVGå›¾æ ‡
      Text(this.getTabIcon(index))
        .fontSize(24)
        .fontColor(this.currentTabIndex === index ? AppColors.primary : AppColors.textSecondary)

      Text(item.name)
        .fontSize(AppTypography.fontSizeSmall)
        .fontColor(this.currentTabIndex === index ? AppColors.primary : AppColors.textSecondary)
        .fontWeight(this.currentTabIndex === index ? AppTypography.fontWeightMedium : AppTypography.fontWeightNormal)
    }
    .width('100%')
    .height('100%')
    .justifyContent(FlexAlign.Center)
  }

  // è·å–Tabå›¾æ ‡ï¼ˆä½¿ç”¨Emojiä½œä¸ºä¸´æ—¶æ–¹æ¡ˆï¼‰
  getTabIcon(index: number): string {
    const icons = ['ğŸ ', 'ğŸ“±', 'ğŸ›’', 'ğŸ‘¤'];
    return icons[index] || '';
  }

  build() {
    Column() {
      // ä¸»å†…å®¹åŒºåŸŸ - ä½¿ç”¨Tabså®ç°é¡µé¢åˆ‡æ¢
      Tabs({
        index: this.currentTabIndex,
        barPosition: BarPosition.End
      }) {
        // é¦–é¡µ
        TabContent() {
          HomePage()
        }
        .tabBar(this.TabItemBuilder(this.tabItems[0], 0))

        // åˆ†ç±»
        TabContent() {
          CategoryPage()
        }
        .tabBar(this.TabItemBuilder(this.tabItems[1], 1))

        // è´­ç‰©è½¦
        TabContent() {
          CartPage()
        }
        .tabBar(this.TabItemBuilder(this.tabItems[2], 2))

        // æˆ‘çš„
        TabContent() {
          MePage()
        }
        .tabBar(this.TabItemBuilder(this.tabItems[3], 3))
      }
      .width('100%')
      .height('100%')
      .barMode(BarMode.Fixed)
      .barHeight(AppDimensions.bottomBarHeight)
      .barBackgroundColor(AppColors.surface)
      .onChange((index: number) => {
        this.currentTabIndex = index;
      })
    }
    .width('100%')
    .height('100%')
    .backgroundColor(AppColors.background)
  }
}

/**
 * Tabé¡¹æ•°æ®ç»“æ„
 */
interface TabItem {
  name: string;
  icon: Resource;
  selectedIcon: Resource;
}

